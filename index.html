<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>ì‚¬ìì˜ í„± ë””ì§€í„¸ ì‹œíŠ¸ - ë³µì› ì™„ë£Œ</title>
    <script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-database-compat.js"></script>
    <style>
        * { box-sizing: border-box; }
        body { font-family: 'Noto Sans KR', sans-serif; background: #f0f0f0; display: flex; justify-content: center; padding: 10px; margin: 0; }
        .sheet { width: 100%; max-width: 600px; background: white; padding: 20px; border: 2px solid #333; box-shadow: 10px 10px 0px #444; }
        h2 { text-align: center; border-bottom: 2px solid #333; padding-bottom: 10px; margin-top: 0; font-size: 20px; }
        .slot-bar { display: flex; gap: 5px; margin-bottom: 15px; background: #eee; padding: 10px; border-radius: 5px; flex-wrap: wrap; align-items: center; }
        .slot-bar select { flex: 1; min-width: 100px; height: 40px; padding: 5px 10px; font-size: 14px; border: 1px solid #bbb; border-radius: 3px; background-color: white; }
        .btn-sm { padding: 0 10px; height: 40px; font-size: 11px; background: #444; color: white; border: none; cursor: pointer; border-radius: 3px; white-space: nowrap; }
        .btn-del { background: #e74c3c; }
        .btn-unlock { background: #e67e22 !important; }
        .stat-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin-top: 10px; width: 100%; }
        .stat-item { display: flex; flex-direction: column; gap: 4px; width: 100%; }
        .stat-item label { font-weight: bold; font-size: 12px; color: #666; }
        input, .job-select { width: 100%; padding: 10px; border: 1px solid #bbb; border-radius: 3px; font-size: 14px; height: 40px; background-color: white; }
        input[readonly] { background-color: #f9f9f9; }
        .sect { background: #444; color: white; padding: 4px 10px; margin: 15px 0 8px; font-weight: bold; font-size: 13px; }
        .sect-share { background: #d35400; } 

        /* íŒë§¤ íŒì—… ë°°ê²½ */
#sellModal {
    position: fixed; top: 0; left: 0; width: 100%; height: 100%;
    background: rgba(0,0,0,0.6); display: none; /* í‰ì†Œì—” ìˆ¨ê¹€ */
    align-items: center; justify-content: center; z-index: 2000;
}
/* íŒë§¤ íŒì—… ë°•ìŠ¤ */
.sell-box {
    background: #fff5e6; border: 3px solid #d32f2f; border-radius: 12px;
    padding: 20px; width: 260px; text-align: center; box-shadow: 0 4px 20px rgba(0,0,0,0.3);
}
.sell-title { font-weight: bold; color: #d32f2f; margin-bottom: 15px; font-size: 16px; }
.sell-btns { display: flex; gap: 10px; justify-content: center; }
.btn-sell-confirm { background: #d32f2f; color: white; border: none; padding: 10px 20px; border-radius: 5px; cursor: pointer; font-weight: bold; }
.btn-sell-cancel { background: #757575; color: white; border: none; padding: 10px 20px; border-radius: 5px; cursor: pointer; }

        /* êµ¬ë§¤ ì„ íƒ ëª¨ë‹¬ ìŠ¤íƒ€ì¼ */
.modal-overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.7); display: none; justify-content: center; align-items: center; z-index: 1000; }
.modal-content { background: white; padding: 20px; border-radius: 8px; width: 90%; max-width: 320px; text-align: center; box-shadow: 0 4px 15px rgba(0,0,0,0.3); }
.modal-title { font-weight: bold; margin-bottom: 15px; font-size: 16px; line-height: 1.4; }
.modal-btns { display: flex; flex-direction: column; gap: 8px; }
.btn-modal { width: 100%; padding: 12px; border: none; border-radius: 5px; cursor: pointer; font-size: 14px; font-weight: bold; }
.btn-buy { background: #e74c3c; color: white; }
.btn-reward { background: #27ae60; color: white; }
.btn-cancel { background: #95a5a6; color: white; }

/* ì¸ë²¤í† ë¦¬ ìŠ¤íƒ€ì¼ */
.inventory-container { display: flex; flex-wrap: wrap; gap: 5px; margin-bottom: 10px; padding: 10px; background: #f9f9f9; border: 1px solid #ccc; border-radius: 5px; }
.inv-item { background: #fff; border: 1px solid #333; padding: 4px 8px; font-size: 11px; display: flex; align-items: center; gap: 4px; border-radius: 3px; }
.inv-item b { color: #bc6c25; }
.inv-btn { cursor: pointer; border: none; background: #eee; padding: 2px 4px; border-radius: 2px; font-size: 10px; }
.inv-btn:hover { background: #ddd; }
.btn-trade { color: #2980b9; } /* ê±°ë˜ ì•„ì´ì½˜ ìƒ‰ìƒ */
.btn-sell { color: #c0392b; }  /* íŒë§¤ ì•„ì´ì½˜ ìƒ‰ìƒ */

/* ì†Œìœ ì£¼ ë°°ì§€ ìŠ¤íƒ€ì¼ */
.stock-owner-line { 
    display: flex; 
    align-items: center; 
    gap: 4px; 
    font-size: 10px; 
    color: #888; 
    border-top: 1px dotted #eee;
    padding-top: 4px;
}

.owner-tag-group { display: flex; gap: 2px; align-items: center; }
.owner-tag { 
    font-size: 9px; padding: 1px 3px; border-radius: 2px; 
    color: white; font-weight: bold; line-height: 1;
}
/* ì§ì—…ë³„ ê³ ìœ  ìƒ‰ìƒ */
.tag-ë„ë¼ { background-color: #e67e22; }
.tag-ì ìœ„ { background-color: #e74c3c; }
.tag-ì² ê±° { background-color: #795548; }
.tag-ê³µí—ˆ { background-color: #8e44ad; }

        /* íŠ¹í˜œ(Perks) ë””ìì¸ ë³µì› */
        .perk-item { display: flex; gap: 10px; font-size: 12px; margin-bottom: 6px; border-bottom: 1px solid #f2f2f2; padding-bottom: 3px; align-items: flex-start; word-break: keep-all; }
        .chk-group { display: flex; gap: 3px; min-width: 55px; flex-shrink: 0; padding-top: 2px; }
        .p-chk, .circle-chk { border: 1px solid #333; appearance: none; cursor: pointer; background: white; width: 16px; height: 16px; position: relative; flex-shrink: 0; }
        .circle-chk { border-radius: 50%; width: 18px; height: 18px; }
        .p-chk:checked::after, .circle-chk:checked::after { content: "âœ”"; color: #333; font-size: 14px; position: absolute; left: 0px; top: -3px; font-weight: bold; }
        
        /* ì•„ì´ì½˜ ë””ìì¸ ë³µì› */
        .icon { font-weight: bold; padding: 1px 3px; border-radius: 3px; color: white; font-size: 10px; margin: 0 1px; vertical-align: middle; }
        .fire { background: #e67e22; } .light { background: #f1c40f; color: #333; } .earth { background: #795548; }
        .dark { background: #2c3e50; } .air { background: #3498db; } .ice { background: #74b9ff; }
        .status { background: #8e44ad; } .heal { background: #27ae60; } .shield { background: #7f8c8d; }
        .poison { background: #2ecc71; } .wound { background: #e74c3c; } .immob { background: #f39c12; } .curse { background: #333; }
        
        /* ì•„ì´í…œ ìƒì  ë””ìì¸ */
        .shop-container { 
    display: grid; 
    grid-template-columns: repeat(auto-fill, minmax(130px, 1fr)); 
    gap: 8px; 
    max-height: 250px; /* ë†’ì´ë¥¼ ì¡°ê¸ˆ ë” í™•ë³´ */
    overflow-y: auto; 
    padding: 10px; 
    background: #fdf6e3; 
    border: 1px inset #ccc; 
    border-radius: 5px; 
    margin-bottom: 10px;
}
.shop-item { 
    background: white; 
    border: 1px solid #d4a373; 
    border-radius: 4px; 
    padding: 8px 6px; 
    font-size: 11px; 
    cursor: pointer; 
    text-align: left; /* ì™¼ìª½ ì •ë ¬ */
    position: relative; 
    display: flex;
    flex-direction: column;
    justify-content: space-between;
}
        .shop-item b { color: #bc6c25; font-size: 12px; margin-bottom: 2px; }
.shop-item .price { color: #e74c3c; font-weight: bold; margin-bottom: 4px; }
        .shop-item .price { color: #e74c3c; font-weight: bold; }
        .shop-item .stock { font-size: 9px; color: #888; }
        .shop-item.sold-out { background: #eee; opacity: 0.6; cursor: not-allowed; }
        .sold-out-badge { color: white; background: #e74c3c; font-size: 9px; padding: 1px 3px; border-radius: 3px; position: absolute; top: 2px; right: 2px; }

        textarea { width: 100%; height: 80px; margin-top: 5px; border: 1px solid #ccc; padding: 8px; font-size: 12px; resize: vertical; }
        .backup-bar { display: flex; gap: 5px; margin-top: 15px; border-top: 1px solid #ddd; padding-top: 10px; }
    </style>
</head>
<body>
<div class="sheet">
    <h2 id="title">ì§ì—… ì‹œíŠ¸ (ì—°ê²° ì¤‘...)</h2>
    <div class="slot-bar">
        <select id="slotSelect" onchange="switchSlot(this.value)"></select>
        <button class="btn-sm" onclick="addNewParty()">+ íŒŒí‹°</button>
        <button class="btn-sm btn-del" onclick="deleteParty()">ì‚­ì œ</button>
        <button class="btn-sm" onclick="manualReset()">ì´ˆê¸°í™”</button>
    </div>

    <div class="stat-item" style="margin-bottom:10px;">
        <label>ì§ì—… ì„ íƒ</label>
        <select id="job" class="job-select" onchange="changeJob(this.value)">
            <option value="ë„ë¼íˆ¬ì²™ìˆ˜">ì´ë…¹ìŠ¤ ë„ë¼íˆ¬ì²™ìˆ˜</option>
            <option value="ì ìœ„ë³‘">ë°œë¼ìŠ¤ ì ìœ„ë³‘</option>
            <option value="ì² ê±°ì „ë¬¸ê°€">ì¿¼íŠ¸ë¦´ ì² ê±°ì „ë¬¸ê°€</option>
            <option value="ê³µí—ˆê°ì‹œì">ì¸ê°„ ê³µí—ˆê°ì‹œì</option>
        </select>
    </div>

    <div class="stat-grid">
        <div class="stat-item"><label>ìºë¦­í„° ì´ë¦„</label><input type="text" id="charName"></div>
        <div class="stat-item"><label>ë ˆë²¨ (Lv) - ìë™</label><input type="number" id="lv" readonly></div>
        <div class="stat-item"><label>ê²½í—˜ì¹˜ (XP)</label><input type="number" id="xp" oninput="calcLevel()"></div>
        <div class="stat-item"><label>ê³¨ë“œ (Gold)</label><input type="number" id="gold"></div>
    </div>

    <div class="sect">íŠ¹í˜œ (PERKS)</div>
    <div id="perks"></div>

    <div class="sect">ì²´í¬ë§ˆí¬ (BATTLE GOALS)</div>
    <div id="battleGoals" style="display:grid; grid-template-columns: 1fr 1fr; gap:10px;"></div>
    <div class="sect">ğŸ’ ë‚´ ì¸ë²¤í† ë¦¬ (ìë™ ì •ë ¬)</div>
    <div id="inventoryGrid" class="inventory-container"></div>
    <div class="sect">ğŸ›’ ì•„ì´í…œ ìƒì  (í´ë¦­í•˜ì—¬ êµ¬ë§¤)</div>
    <div id="shopGrid" class="shop-container"></div>
    <div style="margin-bottom:10px; display:flex; gap:5px; align-items:center;">
        <label style="font-size:11px; font-weight:bold;">ğŸ”“ í•´ê¸ˆ:</label>
        <input type="text" id="unlockInput" placeholder="ì˜ˆ: 15 ë˜ëŠ” 14-25" style="width:120px; height:30px;">
        <button class="btn-sm btn-unlock" style="height:30px;" onclick="unlockItems()">í•´ê¸ˆ</button>
    </div>
    <textarea id="memo" placeholder="êµ¬ì…í•œ ì•„ì´í…œ ë° ê°œì¸ ë©”ëª¨..."></textarea>

    <div class="sect sect-share">ì‹œë‚˜ë¦¬ì˜¤ ë° ë§µ ì§„í–‰ ìƒí™© (íŒŒí‹° ê³µìœ )</div>
    <textarea id="mapProgress"></textarea>

    <div class="backup-bar">
        <button class="btn-sm" style="flex:1; background:#27ae60" onclick="exportData()">íŒŒì¼ ë°±ì—…</button>
        <button class="btn-sm" style="flex:1; background:#2980b9" onclick="document.getElementById('fileInput').click()">íŒŒì¼ ë³µêµ¬</button>
        <input type="file" id="fileInput" style="display:none" onchange="importData(this)">
    </div>

    <div id="buyModal" class="modal-overlay">
    <div class="modal-content">
        <div id="modalTitle" class="modal-title">ì•„ì´í…œ íšë“</div>
        <div class="modal-btns">
            <button id="btnBuy" class="btn-modal btn-buy">ê³¨ë“œë¡œ êµ¬ë§¤</button>
            <button id="btnReward" class="btn-modal btn-reward">ì‹œë‚˜ë¦¬ì˜¤ ë³´ìƒ (0G)</button>
            <button onclick="closeModal()" class="btn-modal btn-cancel">ì·¨ì†Œ</button>
        </div>
    </div>
</div>


<script>
    const firebaseConfig = {
        apiKey: "AIzaSyDRkc05Xyt_FKn2PcuWnSy58On4WE9dlV0",
        authDomain: "pangea-49c0b.firebaseapp.com",
        databaseURL: "https://pangea-49c0b-default-rtdb.firebaseio.com",
        projectId: "pangea-49c0b",
        storageBucket: "pangea-49c0b.firebasestorage.app",
        messagingSenderId: "793854305747",
        appId: "1:793854305747:web:aff5c62af396dcb2cbbb26"
    };
    firebase.initializeApp(firebaseConfig);
    const db = firebase.database();

    const itemDB = {
        1:["ë¨¸ë¦¬","ë…ìˆ˜ë¦¬ ëˆˆ ê³ ê¸€",30,2], 2:["ë¨¸ë¦¬","ì²  íˆ¬êµ¬",20,2], 3:["ëª¸","ì‡ ì‚¬ìŠ¬ ê°‘ì˜·",30,2], 4:["ëª¸","ì§• ë°•ì€ ê°€ì£½ ê°‘ì˜·",25,2], 5:["ë‹¤ë¦¬","ë‚¡ì€ ì¥í™”",15,2], 6:["ë‹¤ë¦¬","ë‚ ê°œ ë‹¬ë¦° ì‹ ë°œ",15,2], 7:["í•œì†","ë‹¤ë¦¬ë¯¸ê¼´ ë°©íŒ¨",20,2], 8:["í•œì†","íˆ¬ì²™ìš© ë§ì¹˜",30,2], 9:["í•œì†","ë… ë‹¨ê²€",20,2], 10:["í•œì†","ê°•ì²  ì°½",20,2], 11:["ì†Œëª¨í’ˆ","ì¹˜ë£Œ ë¬¼ì•½",10,2], 12:["ì†Œëª¨í’ˆ","í™œë ¥ ë¬¼ì•½",10,2], 13:["ì†Œëª¨í’ˆ","í˜ ë¬¼ì•½",10,2], 14:["ì†Œëª¨í’ˆ","ë§ˆë‚˜ ë¬¼ì•½",10,2], 15:["ì†Œëª¨í’ˆ","ìƒëª…ì˜ ë¶€ì ",20,1], 16:["ëª¸","ì´ˆí˜¼ì˜ ë¡œë¸Œ",40,1], 17:["ë‹¤ë¦¬","í¸ì•ˆí•œ ì‹ ë°œ",30,1], 18:["í•œì†","ì „íˆ¬ ë„ë¼",25,1], 19:["í•œì†","ê²€ì€ ì–‘ì´ˆ",40,1], 20:["ì†Œëª¨í’ˆ","ê¸°ì ˆ ê°€ë£¨",20,2], 21:["ë¨¸ë¦¬","ì†¡ê³¨ë§¤ íˆ¬êµ¬",20,1], 22:["ëª¸","ë‚ ë¶™ì´ ê°‘ì˜·",45,1], 23:["ë‹¤ë¦¬","í™œë³´ì˜ ì¥í™”",30,1], 24:["ì†Œëª¨í’ˆ","íœ˜ë°œì„± í­íƒ„",40,1], 25:["í•œì†","ê°€ì‹œ ë‹ì¹œ ì‚¬ìŠ¬",30,1], 26:["ì†Œëª¨í’ˆ","ë–¡ê°ˆë‚˜ë¬´ ë¶€ì ",30,2], 27:["ì†Œëª¨í’ˆ","ìš´ëª… ë‚˜ì¹¨ë°˜",25,1], 28:["ëª¸","ë²¼ë£©íˆ¬ì„±ì´ ìˆ„",10,1], 29:["í•œì†","ëŒ€í˜• ë°©íŒ¨",40,1], 30:["ì†Œëª¨í’ˆ","ì‹ ì†ì˜ ë°˜ì§€",40,1], 31:["ì†Œëª¨í’ˆ","í˜ì˜ ë°˜ì§€",40,1], 32:["ì†Œëª¨í’ˆ","íšŒë³µì˜ ë°˜ì§€",40,1], 33:["ì†Œëª¨í’ˆ","ê°•ì²  ë°˜ì§€",30,1], 34:["í•œì†","ê°€ì‹œ ë‹ì¹œ ë„ë¼",40,1], 35:["ëª¸","ëª…ë ¹ì˜ ë¡œë¸Œ",40,1], 36:["ë‹¤ë¦¬","ì œíŠ¸ ì¥í™”",30,1]
    };

    const D = {
        "ë„ë¼íˆ¬ì²™ìˆ˜": [{n:2, t:"'-1' ì¹´ë“œ 2ì¥ì„ ì œê±°"}, {n:1, t:"'0' ì¹´ë“œ 1ì¥ì„ '+2 <span class='icon status'>í˜¼ë€</span>' ì¹´ë“œ 1ì¥ìœ¼ë¡œ êµì²´"}, {n:1, t:"'0' ì¹´ë“œ 1ì¥ì„ '+1 <span class='icon poison'>ì¤‘ë…</span>' ì¹´ë“œ 1ì¥ìœ¼ë¡œ êµì²´"}, {n:1, t:"'0' ì¹´ë“œ 1ì¥ì„ '+1 <span class='icon wound'>ë¶€ìƒ</span>' ì¹´ë“œ 1ì¥ìœ¼ë¡œ êµì²´"}, {n:1, t:"'0' ì¹´ë“œ 1ì¥ì„ '+1 <span class='icon immob'>ì´ë™ë¶ˆê°€</span>' ì¹´ë“œ 1ì¥ìœ¼ë¡œ êµì²´"}, {n:1, t:"'0' ì¹´ë“œ 1ì¥ì„ '+1 [ë°€ê¸° 2]' ì¹´ë“œ 1ì¥ìœ¼ë¡œ êµì²´"}, {n:1, t:"'0' ì¹´ë“œ 1ì¥ì„ '+0 <span class='icon status'>ê¸°ì ˆ</span>' ì¹´ë“œ 1ì¥ìœ¼ë¡œ êµì²´"}, {n:1, t:"'+1' ì¹´ë“œ 1ì¥ì„ '+1 <span class='icon status'>ê¸°ì ˆ</span>' ì¹´ë“œ 1ì¥ìœ¼ë¡œ êµì²´"}, {n:3, t:"'+2 <span class='icon air'>ê³µê¸°</span>' ì¹´ë“œ 1ì¥ì„ ì¶”ê°€"}, {n:3, t:"'+1' ì¹´ë“œ 1ì¥ì„ '+3' ì¹´ë“œ 1ì¥ìœ¼ë¡œ êµì²´"}],
        "ì ìœ„ë³‘": [{n:1, t:"'0' ì¹´ë“œ 4ì¥ì„ ì œê±°"}, {n:1, t:"'-1' ì¹´ë“œ 2ì¥ì„ ì œê±°"}, {n:1, t:"'-2' ì¹´ë“œ 1ì¥ ë° '+1' ì¹´ë“œ 1ì¥ì„ ì œê±°"}, {n:2, t:"'-1' ì¹´ë“œ 1ì¥ì„ '+1' ì¹´ë“œ 1ì¥ìœ¼ë¡œ êµì²´"}, {n:2, t:"'+1' ì¹´ë“œ 1ì¥ì„ '+2 <span class='icon fire'>ë¶ˆ</span>' ì¹´ë“œ 1ì¥ìœ¼ë¡œ êµì²´"}, {n:2, t:"'+1' ì¹´ë“œ 1ì¥ì„ '+2 <span class='icon light'>ë¹›</span>' ì¹´ë“œ 1ì¥ìœ¼ë¡œ êµì²´"}, {n:2, t:"'+1 <span class='icon fire'>ë¶ˆ</span>,<span class='icon fire'>ë¹›</span>' ì¹´ë“œ 1ì¥ì„ ì¶”ê°€"}, {n:2, t:"'+1 [ë°©ì–´ 1] <span class='icon shield'>ğŸ›¡ï¸</span>' ì¹´ë“œ 1ì¥ì„ ì¶”ê°€"}, {n:1, t:"'0' ì¹´ë“œ 1ì¥ì„ '+1 <span class='icon immob'>ì´ë™ë¶ˆê°€</span>' ì¹´ë“œ 1ì¥ìœ¼ë¡œ êµì²´"}, {n:1, t:"'0' ì¹´ë“œ 1ì¥ì„ '+1 <span class='icon wound'>ë¶€ìƒ</span>' ì¹´ë“œ 1ì¥ìœ¼ë¡œ êµì²´"}],
        "ì² ê±°ì „ë¬¸ê°€": [{n:1, t:"'0' ì¹´ë“œ 4ì¥ì„ ì œê±°"}, {n:2, t:"'-1' ì¹´ë“œ 2ì¥ì„ ì œê±°"}, {n:1, t:"'-2' ì¹´ë“œ 1ì¥ ë° '+1' ì¹´ë“œ 1ì¥ì„ ì œê±°"}, {n:2, t:"'0' ì¹´ë“œ 1ì¥ì„ '+2 <span class='icon status'>í˜¼ë€</span>' ì¹´ë“œ 1ì¥ìœ¼ë¡œ êµì²´"}, {n:2, t:"'-1' ì¹´ë“œ 1ì¥ì„ '+0 <span class='icon poison'>ì¤‘ë…</span>' ì¹´ë“œ 1ì¥ìœ¼ë¡œ êµì²´"}, {n:2, t:"'+2' ì¹´ë“œ 1ì¥ì„ ì¶”ê°€"}, {n:2, t:"'+1' ì¹´ë“œ 1ì¥ì„ '+2 <span class='icon earth'>ë•…</span>' ì¹´ë“œ 1ì¥ìœ¼ë¡œ êµì²´"}, {n:2, t:"'+1' ì¹´ë“œ 1ì¥ì„ '+2 <span class='icon fire'>ë¶ˆ</span>' ì¹´ë“œ 1ì¥ìœ¼ë¡œ êµì²´"}, {n:2, t:"'0' ì¸ì ‘í•œ ëª¨ë“  ì  í”¼í•´ 1 ì¹´ë“œ 1ì¥ ì¶”ê°€"}],
        "ê³µí—ˆê°ì‹œì": [{n:1, t:"'-1' ì¹´ë“œ 2ì¥ì„ ì œê±°"}, {n:1, t:"'-2' ì¹´ë“œ 1ì¥ì„ ì œê±°"}, {n:2, t:"'0' ì¹´ë“œ 1ì¥ì„ '+1 <span class='icon dark'>ì–´ë‘ </span>' ì¹´ë“œ 1ì¥ìœ¼ë¡œ êµì²´"}, {n:2, t:"'0' ì¹´ë“œ 1ì¥ì„ '+1 <span class='icon ice'>ëƒ‰ê¸°</span>' ì¹´ë“œ 1ì¥ìœ¼ë¡œ êµì²´"}, {n:2, t:"'-1' ì¹´ë“œ 1ì¥ì„ '+0 [ì¹˜ìœ  1 <span class='icon heal'>â™¥</span> ì•„êµ°]' ì¹´ë“œ 1ì¥ìœ¼ë¡œ êµì²´"}, {n:3, t:"'+1 [ì¹˜ìœ  1 <span class='icon heal'>â™¥</span> ì•„êµ°]' ì¹´ë“œ 1ì¥ì„ ì¶”ê°€"}, {n:1, t:"'+1 <span class='icon poison'>ì¤‘ë…</span>' ì¹´ë“œ 1ì¥ì„ ì¶”ê°€"}, {n:1, t:"'+3' ì¹´ë“œ 1ì¥ì„ ì¶”ê°€"}, {n:2, t:"'+1 <span class='icon curse'>ì €ì£¼</span>' ì¹´ë“œ 1ì¥ì„ ì¶”ê°€"}]
    };

    let currentSlot = localStorage.getItem('jotl_slot_v17') || "ê¸°ë³¸ íŒŒí‹°";
    let isSyncing = false;
    let unlockedItems = [];
    let partyItemCounts = {};

    function calcLevel() {
        const xp = parseInt(document.getElementById('xp').value) || 0;
        let lv = 1;
        const th = [0, 45, 95, 150, 210, 275, 345, 420, 500];
        th.forEach((v, i) => { if(xp >= v) lv = i + 1; });
        document.getElementById('lv').value = lv > 9 ? 9 : lv;
        saveData();
    }

    function renderEmptyUI(job) {
        const p = document.getElementById('perks');
        const bg = document.getElementById('battleGoals');
        p.innerHTML = ''; bg.innerHTML = '';
        D[job].forEach((o, i) => {
            let chks = '';
            for(let j=0; j<o.n; j++) chks += `<input type="checkbox" class="p-chk" id="p_${i}_${j}" onchange="saveData()">`;
            p.innerHTML += `<div class="perk-item"><div class="chk-group">${chks}</div><span>${o.t}</span></div>`;
        });
        for(let i=0; i<6; i++) {
            let chks = '';
            for(let j=0; j<3; j++) chks += `<input type="checkbox" class="circle-chk" id="b_${i}_${j}" onchange="saveData()">`;
            bg.innerHTML += `<div style="border:1px solid #ddd; padding:8px; display:flex; align-items:center; gap:5px; justify-content:center;"><span>âœ”</span>${chks}</div>`;
        }
    }

function renderShop() {
    const shopGrid = document.getElementById('shopGrid');
    if (!shopGrid) return;
    shopGrid.innerHTML = '';

    Object.entries(itemDB).forEach(([num, item]) => {
        const itemNum = Number(num);
        // í•´ê¸ˆ ì—¬ë¶€ ì²´í¬
        if (!unlockedItems.includes(itemNum)) return;

        const [id, name, price, stock] = item;
        
        // 1. ì†Œìœ ì£¼ ëª…ë‹¨ ì¤€ë¹„
        const owners = (window.currentItemOwners && window.currentItemOwners[itemNum]) || [];
        const ownerTags = owners.map(name => `<span class="owner-tag tag-${name}">${name}</span>`).join("");

        // 2. ì¬ê³  ê³„ì‚°
        const currentCount = partyItemCounts[itemNum] || 0;
        const remainingStock = stock - currentCount;

        // 3. ì•„ì´í…œ ì¹´ë“œ ìƒì„±
        const itemDiv = document.createElement('div');
        itemDiv.className = `shop-item ${remainingStock <= 0 ? 'sold-out' : ''}`;
        
        itemDiv.innerHTML = `
            <div>
                <b>#${num} ${name}</b>
                <div class="price">${price}G</div>
            </div>
            <div class="stock-owner-line">
                <span>ì¬ê³ : ${remainingStock}</span>
                ${owners.length > 0 ? `<div class="owner-tag-group"> | ${ownerTags}</div>` : ""}
            </div>
            ${remainingStock <= 0 ? '<span class="sold-out-badge">í’ˆì ˆ</span>' : ''}
        `;

        if (remainingStock > 0) {
            itemDiv.onclick = () => quickBuy(itemNum); // ê¸°ì¡´ ëª¨ë‹¬ í•¨ìˆ˜ ì—°ê²°
        }

        shopGrid.appendChild(itemDiv);
    });
}

  // ëª¨ë‹¬ ë‹«ê¸° í•¨ìˆ˜
function closeModal() {
    document.getElementById('buyModal').style.display = 'none';
}

function quickBuy(num) {
    const item = itemDB[num];
    const gold = parseInt(document.getElementById('gold').value) || 0;
    const modal = document.getElementById('buyModal');
    const title = document.getElementById('modalTitle');
    const btnBuy = document.getElementById('btnBuy');
    const btnReward = document.getElementById('btnReward');

    // ëª¨ë‹¬ í…ìŠ¤íŠ¸ ì„¤ì •
    title.innerHTML = `<span style="color:#bc6c25;">[#${num}] ${item[1]}</span><br>${item[2]} Gold`;
    modal.style.display = 'flex';

    // 1. ê³¨ë“œ êµ¬ë§¤ ë²„íŠ¼ í´ë¦­ ì‹œ
    btnBuy.onclick = () => {
        if (gold < item[2]) {
            alert("ê³¨ë“œê°€ ë¶€ì¡±í•©ë‹ˆë‹¤!");
            return;
        }
        document.getElementById('gold').value = gold - item[2];
        addMemoItem(num, item[1], false);
        closeModal();
    };

    // 2. ë³´ìƒ íšë“ ë²„íŠ¼ í´ë¦­ ì‹œ
    btnReward.onclick = () => {
        addMemoItem(num, item[1], true);
        closeModal();
    };
}

function addMemoItem(num, itemName, isReward) {
    const memo = document.getElementById('memo');
    const suffix = isReward ? "ë³´" : "";
    const newEntry = `[#${num}${suffix}]`;

    let currentContent = memo.value;
    const existingItems = currentContent.match(/\[#\d+(?:ë³´)?\]/g) || [];
    
    // ì•„ì´í…œ ë²ˆí˜¸ì™€ ê·¸ ë’¤ì— ë¶™ì€ ì´ë¦„ í…ìŠ¤íŠ¸ê¹Œì§€ ì‹¹ ì œê±°í•´ì„œ ìˆœìˆ˜ ë©”ëª¨ë§Œ ë‚¨ê¹€
    let personalMemo = currentContent.replace(/\[#\d+(?:ë³´)?\][^\[\n]*/g, "").trim();

    existingItems.push(newEntry);

    // ê°€ë¡œë¡œ ë‚˜ì—´ëœ ì•„ì´í…œ ë²ˆí˜¸ë“¤ + ê°œì¸ ë©”ëª¨
    memo.value = existingItems.join(" ") + (personalMemo ? "\n\n" + personalMemo : "");

    saveData();
}

// ë©”ëª¨ì¥ ê¸°ë¡ì„ ì „ë‹´í•˜ëŠ” ë³´ì¡° í•¨ìˆ˜ (ìƒˆë¡œ ì¶”ê°€)
function addMemoItem(num, itemName, isReward) {
    const memo = document.getElementById('memo');
    const suffix = isReward ? "(ë³´)" : ""; // ë³´ìƒì¼ ê²½ìš° (ë³´) ì¶”ê°€
    const newEntry = `[#${num}] ${itemName}${suffix}`;
    
    memo.value += (memo.value ? "\n" : "") + newEntry;
    saveData();
}

    function unlockItems() {
        const val = document.getElementById('unlockInput').value.trim();
        let toUnlock = [];
        if (val.includes('-') || val.includes('~')) {
            const parts = val.split(/[-~]/);
            for(let i=parseInt(parts[0]); i<=parseInt(parts[1]); i++) if(itemDB[i]) toUnlock.push(i);
        } else {
            const n = parseInt(val); if(itemDB[n]) toUnlock.push(n);
        }
        if(toUnlock.length > 0) {
            unlockedItems = Array.from(new Set([...unlockedItems, ...toUnlock]));
            db.ref(`jotl_v17/slots/${currentSlot}/shared/unlockedItems`).set(unlockedItems).then(() => {
                document.getElementById('unlockInput').value = '';
            });
        }
    }

    function renderInventory() {
    const invGrid = document.getElementById('inventoryGrid');
    const memoValue = document.getElementById('memo').value;
    const itemMatches = memoValue.match(/\[#\d+(?:ë³´)?\]/g) || [];
    
    // ë²ˆí˜¸ìˆœ ì •ë ¬ (ìˆ«ìë§Œ ì¶”ì¶œí•´ì„œ ë¹„êµ)
    itemMatches.sort((a, b) => {
        const numA = parseInt(a.replace(/[^0-9]/g, ""));
        const numB = parseInt(b.replace(/[^0-9]/g, ""));
        return numA - numB;
    });

    invGrid.innerHTML = '';
    itemMatches.forEach(tag => {
        const num = parseInt(tag.replace(/[^0-9]/g, ""));
        const isReward = tag.includes("ë³´");
        const item = itemDB[num];
        if(!item) return;

        const div = document.createElement('div');
        div.className = 'inv-item';
        div.innerHTML = `
            <b>#${num}${isReward?'(ë³´)':''}</b> ${item[1]}
            <button class="inv-btn btn-trade" onclick="tradeItem('${tag}', '${item[1]}')">â‡„</button>
            <button class="inv-btn btn-sell" onclick="sellItem('${tag}', ${num})">S</button>
        `;
        invGrid.appendChild(div);
    });
}

let pendingSell = null; 

// 1. íŒë§¤ ë²„íŠ¼ ëˆŒë €ì„ ë•Œ (ì¸ë²¤í† ë¦¬ì—ì„œ S ë²„íŠ¼ í´ë¦­)
function sellItem(tag, num) {
    const item = itemDB[num];
    if (!item) return;

    pendingSell = { tag, num }; // íŒë§¤í•  íƒœê·¸([#1])ì™€ ë²ˆí˜¸ ì €ì¥
    
    const sellPrice = Math.floor(item[2] / 2); // ê°€ê²© ì ˆë°˜ ê³„ì‚°
    const itemName = item[1];

    // íŒì—…ì°½ ë©”ì‹œì§€ ì—…ë°ì´íŠ¸
    const msgElement = document.getElementById('sellPriceMsg');
    if (msgElement) {
        msgElement.innerHTML = 
            `<span style="color:#d32f2f; font-weight:bold;">${itemName}</span><br>` +
            `íŒë§¤ ê°€ê²©: <span style="color:#5d4037; font-weight:bold;">${sellPrice} Gold</span>`;
    }
    
    document.getElementById('sellModal').style.display = 'flex';
}

// 2. íŒì—…ì—ì„œ [íŒë§¤í•˜ê¸°] ìµœì¢… í´ë¦­ ì‹œ
function confirmSell() {
    if (pendingSell) {
        const { tag, num } = pendingSell;
        const item = itemDB[num];
        const sellPrice = Math.floor(item[2] / 2);

        // ê³¨ë“œ ì¶”ê°€
        const goldInput = document.getElementById('gold');
        const currentGold = parseInt(goldInput.value) || 0;
        goldInput.value = currentGold + sellPrice;

        // ë©”ëª¨ì¥ì—ì„œ ì•„ì´í…œ íƒœê·¸ ì‚­ì œ ë¡œì§
        const memoInput = document.getElementById('memo');
        // íŠ¹ìˆ˜ë¬¸ì([, ]) ì²˜ë¦¬ë¥¼ ìœ„í•´ ì •ê·œì‹ ì´ìŠ¤ì¼€ì´í”„
        const escapedTag = tag.replace(/[.*+?^${}()|[\]\\]/g, '\\$&');
        const reg = new RegExp(escapedTag, 'g');
        
        // í•´ë‹¹ ì•„ì´í…œ íƒœê·¸ë¥¼ ì§€ìš°ê³  ê³µë°± ì •ë¦¬
        memoInput.value = memoInput.value.replace(reg, "").replace(/\s\s+/g, ' ').trim();

        // ì €ì¥ ë° í™”ë©´ ê°±ì‹ 
        saveData();
        renderInventory(); 
        closeSellModal();
        
        alert(`${item[1]}ì„(ë¥¼) íŒë§¤í•˜ê³  ${sellPrice}Gë¥¼ ë°›ì•˜ìŠµë‹ˆë‹¤.`);
    }
}

function closeSellModal() {
    document.getElementById('sellModal').style.display = 'none';
    pendingSell = null;
}

function closeTradeModal() {
    document.getElementById('tradeModal').style.display = 'none';
}

function tradeItem(tag, itemName) {
    const jobs = ["ë„ë¼íˆ¬ì²™ìˆ˜", "ì ìœ„ë³‘", "ì² ê±°ì „ë¬¸ê°€", "ê³µí—ˆê°ì‹œì"];
    const currentJob = document.getElementById('job').value;
    const targets = jobs.filter(j => j !== currentJob); // ë‚´ ì§ì—… ì œì™¸
    
    const modal = document.getElementById('tradeModal');
    const btnGroup = document.getElementById('tradeBtnGroup');
    
    // ì´ì „ ë²„íŠ¼ë“¤ ì´ˆê¸°í™”
    btnGroup.innerHTML = '';
    modal.style.display = 'flex';

    // ëŒ€ìƒ ì§ì—…ë³„ë¡œ ë²„íŠ¼ ìƒì„±
    targets.forEach(targetJob => {
        const btn = document.createElement('button');
        btn.className = 'btn-modal';
        btn.style.background = '#3498db';
        btn.style.color = 'white';
        btn.innerText = targetJob;
        
        btn.onclick = () => {
            if (confirm(`[${itemName}]ì„(ë¥¼) ${targetJob}ì—ê²Œ ì „ì†¡í•˜ì‹œê² ìŠµë‹ˆê¹Œ?`)) {
                executeTrade(tag, targetJob);
                closeTradeModal();
            }
        };
        btnGroup.appendChild(btn);
    });
}

function executeTrade(tag, targetJob) {
    const currentJob = document.getElementById('job').value;
    const memoInput = document.getElementById('memo');
    
    // 1. ë‚´ ë°ì´í„°ì™€ ìƒëŒ€ë°© ë°ì´í„°ë¥¼ ë™ì‹œì— ì²˜ë¦¬í•˜ê¸° ìœ„í•´ DB ì°¸ì¡° ìƒì„±
    const myRef = db.ref(`jotl_v17/slots/${currentSlot}/jobs/${currentJob}/memo`);
    const targetRef = db.ref(`jotl_v17/slots/${currentSlot}/jobs/${targetJob}/memo`);

    // 2. ë‚´ ë©”ëª¨ì¥ì—ì„œ ë¨¼ì € ì§€ìš°ê¸° (í™”ë©´ ì¦‰ì‹œ ë°˜ì˜)
    const escapedTag = tag.replace(/[.*+?^${}()|[\]\\]/g, '\\$&');
    const reg = new RegExp(escapedTag, 'g');
    const updatedMyMemo = memoInput.value.replace(reg, "").replace(/\s\s+/g, ' ').trim();
    
    // ë¡œì»¬ í™”ë©´ ë¯¸ë¦¬ ì—…ë°ì´íŠ¸
    memoInput.value = updatedMyMemo;

    // 3. ì„œë²„ ë°ì´í„° ì—…ë°ì´íŠ¸ (ë‚´ ê²ƒ ì§€ìš°ê³ , ìƒëŒ€ ê²ƒ ì¶”ê°€)
    myRef.set(updatedMyMemo).then(() => {
        return targetRef.once('value');
    }).then(snap => {
        const oldTargetMemo = snap.val() || "";
        const updatedTargetMemo = (oldTargetMemo.trim() ? oldTargetMemo.trim() + " " : "") + tag;
        
        return targetRef.set(updatedTargetMemo);
    }).then(() => {
        alert(`${targetJob}ì—ê²Œ ì „ì†¡ ì™„ë£Œ!`);
        // ìµœì¢…ì ìœ¼ë¡œ í™”ë©´ ë™ê¸°í™”
        renderInventory();
    }).catch(err => {
        console.error("ê±°ë˜ ì¤‘ ì˜¤ë¥˜ ë°œìƒ:", err);
        alert("ê±°ë˜ ì‹¤íŒ¨. ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.");
    });
}
function startSync() {
    const job = document.getElementById('job').value;
    renderEmptyUI(job);
    
    db.ref(`jotl_v17/slots/${currentSlot}`).on('value', snap => {
        isSyncing = true;
        const data = snap.val() || {};
        const jobData = (data.jobs && data.jobs[job]) ? data.jobs[job] : {};
        
        // ë‚´ ë°ì´í„° ë°˜ì˜
        document.getElementById('charName').value = jobData.name || "";
        document.getElementById('xp').value = jobData.xp || 0;
        document.getElementById('lv').value = jobData.lv || 1;
        document.getElementById('gold').value = jobData.gold || 0;

        // ë©”ëª¨ì¥ ì•„ì´í…œ ì •ë ¬ ë¡œì§
        let rawMemo = jobData.memo || "";
        const itemParts = rawMemo.match(/\[#\d+(?:ë³´)?\]/g) || [];
        let cleanMemo = rawMemo.replace(/\[#\d+(?:ë³´)?\][^\[\n]*/g, "").trim();
        if (itemParts.length > 0) {
            document.getElementById('memo').value = itemParts.join(" ") + (cleanMemo ? "\n\n" + cleanMemo : "");
        } else {
            document.getElementById('memo').value = rawMemo;
        }

        const checks = jobData.checks || {};
        document.querySelectorAll('input[type="checkbox"]').forEach(c => c.checked = checks[c.id] || false);
        
        // --- [ì—¬ê¸°ì„œë¶€í„° ì†Œìœ ì£¼ ë¶„ì„ ë¡œì§] ---
        partyItemCounts = {};
        window.currentItemOwners = {}; 

        if(data.jobs) {
            Object.entries(data.jobs).forEach(([jobName, j]) => {
                const shortName = jobName.substring(0, 2);
                const found = (j.memo || "").match(/\[#\d+(?:ë³´)?\]/g);
                if(found) {
                    found.forEach(f => {
                        const n = parseInt(f.replace(/[^0-9]/g, ""));
                        // ìˆ˜ëŸ‰ ì¹´ìš´íŠ¸
                        partyItemCounts[n] = (partyItemCounts[n] || 0) + 1;
                        // ì†Œìœ ì£¼ ëª…ë‹¨ ì¶”ê°€
                        if (!window.currentItemOwners[n]) window.currentItemOwners[n] = [];
                        if (!window.currentItemOwners[n].includes(shortName)) {
                            window.currentItemOwners[n].push(shortName);
                        }
                    });
                }
            });
        }
        // --- [ë¶„ì„ ë] ---

        unlockedItems = (data.shared && data.shared.unlockedItems) || [1,2,3,4,5,6,7,8,9,10,11,12,13];
        
        // í™”ë©´ ê°±ì‹  ìˆœì„œ: ìƒµê³¼ ì¸ë²¤í† ë¦¬ë¥¼ ì°¨ë¡€ë¡œ ê·¸ë¦¼
        renderShop();
        renderInventory();

        document.getElementById('mapProgress').value = (data.shared && data.shared.mapProgress) || "";
        document.getElementById('title').innerText = document.getElementById('job').selectedOptions[0].text + " (ì‹¤ì‹œê°„)";
        
        isSyncing = false;
    });

    // íŒŒí‹° ë¦¬ìŠ¤íŠ¸ ë™ê¸°í™” (ìŠ¬ë¡¯ ì„ íƒ)
    db.ref('jotl_v17/party_list').on('value', snap => {
        const list = snap.val() || ["ê¸°ë³¸ íŒŒí‹°"];
        document.getElementById('slotSelect').innerHTML = list.map(s => 
            `<option value="${s}" ${s===currentSlot?'selected':''}>${s}</option>`
        ).join('');
    });
}

    function saveData() {
        if(isSyncing) return;
        const job = document.getElementById('job').value;
        const checks = {};
        document.querySelectorAll('input[type="checkbox"]').forEach(c => checks[c.id] = c.checked);
        const data = {
            name: document.getElementById('charName').value, lv: document.getElementById('lv').value,
            xp: document.getElementById('xp').value, gold: document.getElementById('gold').value,
            memo: document.getElementById('memo').value, checks: checks
        };
        db.ref(`jotl_v17/slots/${currentSlot}/jobs/${job}`).set(data);
        db.ref(`jotl_v17/slots/${currentSlot}/shared/mapProgress`).set(document.getElementById('mapProgress').value);

        renderInventory();
    }

    function changeJob() { db.ref(`jotl_v17/slots/${currentSlot}`).off(); startSync(); }
    function switchSlot(val) { currentSlot = val; localStorage.setItem('jotl_slot_v17', currentSlot); db.ref(`jotl_v17/slots/${currentSlot}`).off(); startSync(); }
    function addNewParty() {
        const n = prompt("ìƒˆ íŒŒí‹° ì´ë¦„:");
        if(n) {
            db.ref('jotl_v17/party_list').once('value', snap => {
                const list = snap.val() || ["ê¸°ë³¸ íŒŒí‹°"];
                if(!list.includes(n)) { list.push(n); db.ref('jotl_v17/party_list').set(list); switchSlot(n); }
            });
        }
    }

function deleteParty() {
        if(confirm(`í˜„ì¬ íŒŒí‹° '${currentSlot}'ì˜ ëª¨ë“  ë°ì´í„°ë¥¼ ì˜êµ¬ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?`)) {
            // 1. í•´ë‹¹ ìŠ¬ë¡¯ì˜ ìƒì„¸ ë°ì´í„° ì‚­ì œ
            db.ref(`jotl_v17/slots/${currentSlot}`).remove().then(() => {
                // 2. ì „ì²´ íŒŒí‹° ëª©ë¡(party_list)ì—ì„œë„ ì´ë¦„ ì œê±°
                db.ref('jotl_v17/party_list').once('value', snap => {
                    let list = snap.val() || ["ê¸°ë³¸ íŒŒí‹°"];
                    list = list.filter(s => s !== currentSlot);
                    
                    // ë§Œì•½ ëª¨ë“  íŒŒí‹°ë¥¼ ì§€ì› ë‹¤ë©´ ë‹¤ì‹œ 'ê¸°ë³¸ íŒŒí‹°' ìƒì„±
                    if (list.length === 0) list = ["ê¸°ë³¸ íŒŒí‹°"];
                    
                    db.ref('jotl_v17/party_list').set(list).then(() => {
                        alert("ì‚­ì œê°€ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤.");
                        // ì²« ë²ˆì§¸ íŒŒí‹°ë¡œ ì´ë™í•˜ë©° ìƒˆë¡œê³ ì¹¨
                        switchSlot(list[0]);
                        location.reload(); 
                    });
                });
            }).catch(error => {
                alert("ì‚­ì œ ì¤‘ ì˜¤ë¥˜ ë°œìƒ: " + error.message);
            });
        }
    }

    function manualReset() {
        if(confirm("ìºë¦­í„° ì´ˆê¸°í™”?")) {
            db.ref(`jotl_v17/slots/${currentSlot}/jobs/${document.getElementById('job').value}`).remove();
        }
    }

    function exportData() {
        db.ref('jotl_v17').once('value', snap => {
            const blob = new Blob([JSON.stringify(snap.val())], {type: 'application/json'});
            const a = document.createElement('a'); a.href = URL.createObjectURL(blob);
            a.download = `jotl_backup_${new Date().getTime()}.json`; a.click();
        });
    }

    function importData(input) {
        const fr = new FileReader();
        fr.onload = () => { db.ref('jotl_v17').set(JSON.parse(fr.result)).then(() => location.reload()); };
        fr.readAsText(input.files[0]);
    }

window.onload = () => { 
    startSync(); 

    // ê° ì…ë ¥ì°½ì˜ ê°’ì´ ë°”ë€” ë•Œë§ˆë‹¤ ì‹¤í–‰ë  ë¡œì§
    ['charName','gold','memo','mapProgress','xp'].forEach(id => {
        document.getElementById(id).onchange = () => {
            saveData();         // ë°ì´í„°ë¥¼ DBì— ì €ì¥
            renderInventory();  // ì¸ë²¤í† ë¦¬ í™”ë©´ ê°±ì‹  (ì¶”ê°€ëœ ë¶€ë¶„)
        };
    });

    // í˜ì´ì§€ ë¡œë“œ ì‹œ ì²« ë Œë”ë§
    setTimeout(renderInventory, 1000); // DB ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¨ ë’¤ ê·¸ë ¤ì§€ë„ë¡ 1ì´ˆ ì—¬ìœ 
};
</script>
<div id="tradeModal" class="modal-overlay">
    <div class="modal-content">
        <div class="modal-title">ì „ì†¡í•  ëŒ€ìƒì„ ì„ íƒí•˜ì„¸ìš”</div>
        <div id="tradeBtnGroup" class="modal-btns">
            </div>
        <button onclick="closeTradeModal()" class="btn-modal btn-cancel" style="margin-top:10px;">ì·¨ì†Œ</button>
    </div>
</div>

<div id="sellModal">
    <div class="sell-box">
        <div class="sell-title">ğŸ’° ì•„ì´í…œ íŒë§¤</div>
        
        <div id="sellPriceMsg" style="margin-bottom:15px; font-size:14px; line-height:1.5;"></div>
        
        <div class="sell-btns">
            <button id="confirmSellBtn" class="btn-sell-confirm" onclick="confirmSell()">íŒë§¤í•˜ê¸°</button>
            <button onclick="closeSellModal()" class="btn-sell-cancel">ì·¨ì†Œ</button>
        </div>
    </div>
</div>
</body>
</html>
